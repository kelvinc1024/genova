<div class="container">
  <h2 class="title">Latest deploy</h2>
  <% if @deployments.size > 0 %>
    <% @deployments.each do |cluster, deployment| %>
      <h3><%= cluster %></h3>
      <% deployment.each_with_index do |service, i| %>
        <% if i == 0 || i % 3 == 0 %>
          <div class="columns">
        <% end %>
        <div class="column is-4">
          <div class="card">
            <div class="card-content">
              <h4><%= service[:type] %></h4>
              <p class="title">
                <% if service[:service].present? %>
                  <%= service[:service] %>
                <% else %>
                  <%= service[:scheduled_task_rule] %>:<%= service[:scheduled_task_target] %>
                <% end %>
              </p>
              <dl class="subtitle">
                <% if service[:branch].present? %>
                  <dt>Branch</dt>
                  <dd><%= service[:branch] %></dd>
                <% else %>
                  <dt>Tag</dt>
                  <dd><%= service[:tag] %></dd>
                <% end %>
                <dt>Created at</dt>
                <dd><%= service[:created_at] %></dd>
              </dl>
            </div>
          </div>
        </div>
        <% if (i + 1) % 3 == 0 || deployment.size == i + 1 %>
          </div>
        <% end %>
      <% end %>
    <% end %>
  <% else %>
    <p>Deployment does not exist.</p>
  <% end %>
</div>
